---
sr-due: 2023-01-06
sr-interval: 1
sr-ease: 190
---

#review 

# 第一章 案例
- 人去租片，不同类别的片价格不一样。
- 改变来了
	- 现在想去用HTML方式把详单打印出来。
	- 想要增加影片的分类
- 重构的步骤
	- 可靠的测试机制，让测试可以自我检验。
	- 每次小修改之后都要做测试。
>[!INFO] 
>任何一个傻瓜都可以写出计算机可以理解的代码，唯有写出人类容易理解的代码，才是优秀的程序员

- P35 谁不稳定，就让谁多做事情。这样可以尽量减少变化的地方。
```java

class Price {
	abstract double getCharge(int daysRented);
}

class ChilrenPrice extend Price {
	double getCharge(int daysRented) {
		double result = 1.5;
		if (daysRented > 3) {
			result += (daysRented - 3) * 1.5;
		}
		return result;
	}
}

```

# 第二章
- P57 重构就是擦掉窗户上的污垢，让你看得更远。
- P58 重构应该是你想做什么事情，重构可以让你做得更好。  - 事不过三，三则重构。
- P66 未重构的代码就像债务，有空的时候就要还一些，否则久了，利息都还不起。
- P67 先做，再重构优化，相信自己不会做出太烂的东西。-- 先做简单的，多数时候，你不需要灵活且复杂的设计。
- P69 哪怕你完全了解系统，也做一些实际的测量，不要空对空地说。
- P70 性能改进也不必要前期有太多设计，还是在后期找到热点，解决热点。 - 有点摆烂的感觉，但还是要相信自己可以做好。
- P73 重构很重要的一步就是良好的测试环境。

# 第三章 代码的坏味道
- 重复代码
- 过长函数
- 过大的类
- 过长的参数列
- 发散式变化/霰弹式变化
	- 一个类不应该因为多个不同方向上的变化而需要修改。如果有的话，就**拆类**（比如加了银行/增加了金融方案）
	- 针对某一外界变化，应该只有一个类是需要修改的。一个变化在多个地方需要修改的话，就让修改发生在一处，**如果没有合适的类承载，那就造一个**。
- 依恋情结：一个类的函数用了另一个类的半打数据。这种情况就要考虑要不要减少**把这个函数移过去**。
- 数据泥团：有不少参数总是成对出现。如果少了其中一个参数，另一个就失去了意义，那就有必要给他们**建个新类**，并且将相关的函数都移进去。
- Switch： 都应该用**多态**解决，或者用**明确的函数**解决。
- 对不起身价的类就应该消失。
- 夸大设计的未来性：没必要的复杂设计要干掉。
- 如果发现消息链a.b.c.d.e.f这种方式，想办法去掉复杂性。
- 没必要的中间人可以干掉。
- 注释：应该写你为什么做这个事情，少写你怎么做的，因为你怎么做的应该在代码中就展示清楚了。

# 第四章 测试体系
- P89 每个类都应该有自己的测试函数。所有测试都应该是自动化的，为测试写的代码不会浪费的。